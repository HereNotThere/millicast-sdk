<script src="../../dist/millicast.umd.js"></script>
<script src="./utils/Media.js"></script>
<script src="./utils/env.js"></script>
<script src="./PublishTest.js"></script>

<style>
  #stats {
    display: none;
  }

  #stats.show {
    display: block;
  }

  #stats table {
    font-family: arial, sans-serif;
    border-collapse: collapse;
    width: 100%;
  }
  
  #stats table td, #stats table th {
    border: 1px solid #dddddd;
    text-align: left;
    padding: 8px;
  }
  
  #stats table tr:nth-child(even) {
    background-color: #dddddd;
  }
</style>

<div>
  <h1>Publish</h1>
  <br />
  <h3 id="broadcast-status-label">READY!</h3> <h3 id="broadcast-viewers"></h3>
  <table>
    <tr>
      <th>Publisher</th>
      <th>Viewer</th>
    </tr>
    <tr>
      <td>
        <label for="video-src">Video URL to capture</label>
        <input type="url" id="video-src" size="30">
        <button onclick="millicastPublishTest.loadVideo()">
          Load Video
        </button>
        <button onclick="millicastPublishTest.loadCamera()">
          Load Camera
        </button>
      </td>
      <td>

      </td>
    </tr>
    <tr>
      <td>
        <video muted autoplay controls width="854" height="480" id="millicast-media-video-test" style="display: block;margin: 0 auto;"></video>
      </td>
      <td id="viewer">
        <div style="height: 480px; width: 854px;"></div>
      </td>
    </tr>
  </table>
  <br />
  <fieldset>
    Codec: <select id='codec-select' onchange="millicastPublishTest.changeCodec(this)"> </select>
    Scalability mode: <select id='scalability-mode-select' onchange="millicastPublishTest.changeScalability(this)"></select>

    </select>
    Bitrate: <select id='bitrate-select' onchange="millicastPublishTest.testUpdateBitrate(this)">
      <option value="0" default>Unlimited</option>
      <option value="2000">2000</option>
      <option value="1000">1000</option>
      <option value="500">500</option>
      <option value="250">250</option>
      <option value="125">125</option>
    </select>
    <input type="checkbox" id="simulcast-checkbox" onclick="millicastPublishTest.setSimulcast(this)">
    <label for="simulcast">Simulcast</label>
    <input type="checkbox" id="disable-audio-checkbox" onclick="millicastPublishTest.testMuteAudio(this)">
    <label for="disable-audio">Mute audio</label>
    <input type="checkbox" id="disable-video-checkbox" onclick="millicastPublishTest.testMuteVideo(this)">
    <label for="disable-video">Mute video</label>
  </fieldset>
  <fieldset>
    <button onclick="millicastPublishTest.testStart()">
      Start broadcast
    </button>
    <button onclick="millicastPublishTest.testStop()">
      Stop broadcast
    </button>
    <button onclick="millicastPublishTest.testChangeVideo()">
      Change Video
    </button>
    <button onclick="millicastPublishTest.testGetStats()">
      Get stats
    </button>
    <button onclick="millicastPublishTest.testStopStats()">
      Stop stats
    </button>
  </fieldset>
  <br>
  <div id="stats">
    <table>
      <tr>
        <th>MediaTrack</th>
        <th>Id</th>
        <th>Codec</th>
        <th>Frame height</th>
        <th>Frame width</th>
        <th>Quality limitation reason</th>
        <th>Frames per second</th>
        <th>Bytes sent (total)</th>
        <th>Bitrate (kbps)</th>
        <th>Timestamp</th>
      </tr>
      <tr>
        <td>Video</td>
        <td id="stats-video1-id"></td>
        <td id="stats-video1-mimeType"></td>
        <td id="stats-video1-frameHeight"></td>
        <td id="stats-video1-frameWidth"></td>
        <td id="stats-video1-qualityLimitationReason"></td>
        <td id="stats-video1-framesPerSecond"></td>
        <td id="stats-video1-totalBytesSent"></td>
        <td id="stats-video1-bitrate"></td>
        <td id="stats-video1-timestamp"></td>
      </tr>
      <tr>
        <td>Video</td>
        <td id="stats-video2-id"></td>
        <td id="stats-video2-mimeType"></td>
        <td id="stats-video2-frameHeight"></td>
        <td id="stats-video2-frameWidth"></td>
        <td id="stats-video2-qualityLimitationReason"></td>
        <td id="stats-video2-framesPerSecond"></td>
        <td id="stats-video2-totalBytesSent"></td>
        <td id="stats-video2-bitrate"></td>
        <td id="stats-video2-timestamp"></td>
      </tr>
      <tr>
        <td>Video</td>
        <td id="stats-video3-id"></td>
        <td id="stats-video3-mimeType"></td>
        <td id="stats-video3-frameHeight"></td>
        <td id="stats-video3-frameWidth"></td>
        <td id="stats-video3-qualityLimitationReason"></td>
        <td id="stats-video3-framesPerSecond"></td>
        <td id="stats-video3-totalBytesSent"></td>
        <td id="stats-video3-bitrate"></td>
        <td id="stats-video3-timestamp"></td>
      </tr>
      <tr>
        <td>Audio</td>
        <td id="stats-audio-id"></td>
        <td id="stats-audio-mimeType"></td>
        <td id="stats-audio-frameHeight">-</td>
        <td id="stats-audio-frameWidth">-</td>
        <td id="stats-audio-qualityLimitationReason">-</td>
        <td id="stats-audio-framesPerSecond">-</td>
        <td id="stats-audio-totalBytesSent"></td>
        <td id="stats-audio-bitrate"></td>
        <td id="stats-audio-timestamp"></td>
      </tr>
    </table>
    <br>
    <table>
      <tr>
        <th>Candidate type</th>
        <th>Available outgoing bitrate</th>
        <th>Average round trip time</th>
        <th>Total round trip time</th>
      </tr>
      <tr>
        <td id="stats-candidateType"></td>
        <td id="stats-availableOutgoingBitrate"></td>
        <td id="stats-averageRoundTripTime"></td>
        <td id="stats-totalRoundTripTime"></td>
      </tr>
    </table>
  </div>
</div>
